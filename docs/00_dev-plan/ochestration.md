# 오케스트레이션 (Orchestration)

## 개요

LLM 오케스트레이션은 **[계획 - 실행]**의 구조로 설계한다.

### 기본 분류
- **LLM 기능**: Plan, Chat, Tool Parameter Setting, Analyze, Summary, Visualize(web), User Response 등
- **TOOL 기능**: Built-In Tools, Plug-In Tools, MCP Tools

### 핵심 원칙
- LLM Plan 기능이 본 오케스트레이션의 핵심
- 전체 흐름은 고정적으로 사용
- 두 가지 기능(LLM + TOOL)에 대해서는 별도 상세 정의

## LLM Plan 기능 (핵심)

### 기능 개요
- 사용자의 입력을 받아서 요구사항 분석 및 계획 수립
- 최초 계획 수립 → 단일(혹은 다수) 기능 수행 → 다음 스텝 결정 → 반복

### 실행 흐름
```
사용자 입력 → LLM Plan → 기능 실행 → LLM Plan → ... → 완료
```

### 계획 단계 특징
- 다양한 기능을 사용하는 것 가능
- 계획을 세우지 않고 즉시 사용자 응답도 가능
- 단순 응답: 계획 후 즉시 사용자 응답
- 복합 작업: 기능 수행 후 응답 전문 LLM을 통한 진행

### 프롬프트 요구사항
- **필수 포함**: 모든 기능(LLM 및 TOOL)에 대한 설명(Description)
- **치환 요소**: 각 LLM 기능에 필요한 요소들이 유연하게 치환 가능

## LLM 기능 호출

### 기본 구조
- 각 LLM은 고유한 프롬프트 보유 (설정파일 관리)
- 프롬프트 내 치환 가능한 요소들이 파라미터로 주입
- 실제 모델(GPT, Claude, Local LLM) 선택은 설정으로 관리

### 오케스트레이션 관점
- 어떤 모델을 사용하는지 알 필요 없음
- 어떤 프롬프트를 사용하는지 몰라도 됨
- LLM 기능 종류 선택 + 치환 요소(Dictionary 방식) 파라미터만 주입

### 확장성 원칙
- if-else 조건 분기 방식 지양
- 유연한 확장 가능한 구조 필수
- **구조화된 응답**: LLM 응답은 반드시 구조화 (사용자 최종 응답 제외)

## TOOL 기능 호출

### 공통 요구사항
- **공통 요소**: Tool 이름 + 설명(Description)
- **기능 설명**: Plan LLM이 좋은 계획 수립을 위해 필수

### 3가지 TOOL 유형
1. **Built-In Tools**: Agent 필수 요소 (Memory 등)
2. **Plug-In Tools**: 리플렉션 활용, 유연한 확장
3. **MCP Tools**: MCP 표준 준수

### 파라미터 처리
- **파라미터 없는 Tool**: 직접 호출
- **파라미터 있는 Tool**: LLM 파라미터 결정 작업 진행

## 오케스트레이션 완료

### 완료 조건
- LLM 종류 중 완료 기능(Chat, Response 등) 수행 시 완료 처리
- if-else 조건 분기보다는 우아한 방식으로 처리 (확장성 확보)

## 추가 고려사항

### 향후 확장
- **스트리밍 응답**: 기본 응답 구조 완성 후 지원
- **통일된 Result 구조**: LLM 응답과 도구 응답의 Result 구조 통일 필요

### 설계 목표
- 확장 가능하고 우아한 구현
- 각 구성 요소의 독립성 확보
- 유연한 파라미터 주입 시스템