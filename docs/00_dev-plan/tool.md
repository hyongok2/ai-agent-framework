# TOOL 시스템

## 개요

### TOOL 정의
**Tool = Function + Metadata + Contract**
- **Function**: 실제 수행하는 작업
- **Metadata**: 자기 설명 (이름, 설명, 버전)
- **Contract**: 입출력 스키마

### 3가지 TOOL 구성 방식
- **Built-In Tools**: 내장 도구
- **Plug-In Tools**: 확장 도구
- **MCP Tools**: MCP 도구

### 공통 요구사항
- **유일한 이름**: 모든 Tool은 LLM이 호출할 수 있는 유일한 이름 보유
- **자기 설명**: 자신을 설명할 수 있는 Description 필수
- **동일한 인터페이스**: 모든 Tool은 동일한 구조의 실행 인터페이스 보유
- **유연한 구조**: 입출력 구조는 유연하게 정의
- **타입 투명성**: 외부에서 도구 호출 시 타입(내장/플러그인/MCP) 알 필요 없음

### 설계 원칙
- **Tool 간 비참조**: Tool간 상호 참조 금지, LLM 오케스트레이션을 통해서만 호출
- **LLM 전용**: LLM이 사용하지 않는 기능은 Tool로 정의하지 않음 (별도 프로젝트 구성요소)
- **동일한 관리**: 3가지 방식 모두 동일한 Tool 관리 방식 사용
- **우아한 구현**: 전체 도구 인터페이스 및 구현은 우아한 방식으로 구현
- **Registry 방식**: 전체 도구 리스트는 동등한 구조로 관리, LLM 프롬프트에 제공

## Built-In Tools

### 정의
- 시스템 필수 기능
- 성능과 신뢰성이 필요한 기능

### 포함 대상
- **임베딩 캐싱**: 성능 최적화를 위한 캐싱 기능
- **Vector DB(RAG)**: 검색 증강 생성 기능
- **기타**: 추가 깊은 고찰이 필요한 시스템 핵심 기능들

### 제외 대상 (프로젝트 구성요소로 분류)
- **메모리 관리**: 사용자 정보, 대화 이력 등의 메모리 관리 시스템
- **보조 기능**: 로깅, 모니터링 등의 보조적인 기능들

## Plug-In Tools

### 정의
- 도메인 특화 기능
- 사용자 커스텀 기능
- 에이전트의 성격을 결정하는 도구

### 기술적 구현
- **메타 프로그래밍**: 별도 DLL 파일, Reflection, Attribute 활용
- **Manifest 파일**: Manifest 파일 기반으로 도구 설명
- **독립적 설정**: 각 플러그인 도구 설정(Config)은 플러그인 요소에 포함
- **독립적 운영**: 메인 프로젝트와 독립적으로 관리, 운영, 배포

### 장점
- 유연한 확장성
- 도메인 특화 최적화
- 독립적인 개발 및 배포 가능

## MCP Tools

### 정의
- 좀 더 유연하게 사용자가 확장할 수 있는 도구
- 표준화된 확장 방식 제공

### 기술적 요구사항
- **MCP 표준 준수**: MCP(Model Context Protocol) 표준을 준수
- **인터페이스 추상화**: MCP 인터페이스는 메인 로직과 분리되도록 추상화

### 장점
- 표준 기반 확장
- 더 높은 유연성
- 커뮤니티 생태계 활용 가능

## 기술적 고려사항

### 실행 방식
- **병렬 실행 가능**: Tool은 기술적으로 병렬 실행 가능
- **순차 진행**: LLM이 bottleneck이므로 순차 진행으로 충분

### 이력 관리
- **실행 결과 이력**: Tool 실행 결과는 지속적인 이력 관리 필요
- **디버깅 및 분석**: 문제 해결 및 성능 분석을 위한 데이터 확보

### 캐싱 전략
- **개별 책임**: Tool의 캐싱은 각 Tool의 구현부에서 책임
- **합리적 운영**: Tool별 특성에 맞는 캐싱 전략 적용 가능

## Tool Registry 시스템

### 구조
```
Tool Registry
├── Built-In Tools
│   ├── Tool Name: Description, Contract
│   └── ...
├── Plug-In Tools
│   ├── Tool Name: Description, Contract
│   └── ...
└── MCP Tools
    ├── Tool Name: Description, Contract
    └── ...
```

### 관리 방식
- **동등한 구조**: 모든 Tool은 Registry에서 동등하게 관리
- **LLM 접근**: Plan LLM이 모든 Tool 정보에 접근 가능
- **동적 로딩**: 런타임에 Tool 로딩 및 관리

## 확장성 설계

### 인터페이스 설계
- **공통 인터페이스**: 모든 Tool이 구현해야 하는 공통 인터페이스 정의
- **메타데이터 표준**: Name, Description, Version, Contract 표준화
- **실행 시그니처**: 입력/출력 시그니처 통일

### 등록 메커니즘
- **자동 발견**: Built-In Tools 자동 등록
- **동적 로딩**: Plug-In Tools 동적 로딩 및 등록
- **표준 연결**: MCP Tools 표준 프로토콜을 통한 연결

### 품질 관리
- **Contract 검증**: 입출력 스키마 검증
- **오류 처리**: Tool 실행 오류에 대한 표준 처리
- **모니터링**: Tool 성능 및 안정성 모니터링